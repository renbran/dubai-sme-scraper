{
  "webhook_handler": {
    "method": "POST",
    "url": "/web/hook/22c7e29b-1d45-4ec8-93cc-fe62708bddc7",
    "code": "# Simple Webhook Handler for Odoo CRM\n# Copy this code into your Odoo webhook configuration\n\ntry:\n    # Get lead data from webhook payload\n    company_name = payload.get('Name', 'Unknown Company')\n    company_phone = payload.get('Phone', '')\n    company_email = payload.get('Email', '')\n    company_website = payload.get('Website', '')\n    company_address = payload.get('Address', '')\n    company_category = payload.get('Category', 'Business Services')\n    company_priority = payload.get('Priority', 'MEDIUM')\n    quality_score = payload.get('Quality Score', '5')\n    search_term = payload.get('Search Term', '')\n    \n    # Clean up contact fields\n    if company_phone in ['Contact via website', 'Not available', '']:\n        company_phone = False\n    if company_email in ['Not available', '']:\n        company_email = False  \n    if company_website in ['Not available', '']:\n        company_website = False\n    \n    # Create or find partner (company)\n    partner = env['res.partner'].search([('name', '=', company_name)], limit=1)\n    \n    if not partner:\n        partner = env['res.partner'].create({\n            'name': company_name,\n            'phone': company_phone,\n            'email': company_email,\n            'website': company_website,\n            'street': company_address,\n            'city': 'Dubai',\n            'is_company': True,\n            'company_type': 'company'\n        })\n    \n    # Set priority level\n    lead_priority = '1'  # Medium\n    if company_priority == 'URGENT':\n        lead_priority = '3'\n    elif company_priority == 'HIGH':\n        lead_priority = '2'\n    elif company_priority == 'LOW':\n        lead_priority = '0'\n    \n    # Create lead description\n    description = f'Dubai SME Lead - {company_category}\\n\\nCompany: {company_name}\\nCategory: {company_category}\\nQuality: {quality_score}/10\\nPriority: {company_priority}\\nPhone: {payload.get(\"Phone\", \"N/A\")}\\nEmail: {payload.get(\"Email\", \"N/A\")}\\nWebsite: {payload.get(\"Website\", \"N/A\")}\\nAddress: {company_address}\\n\\nSource: Google Maps Scraper\\nSearch: {search_term}'\n    \n    # Check if lead exists\n    existing_lead = env['crm.lead'].search([\n        ('partner_id', '=', partner.id),\n        ('name', 'ilike', company_name)\n    ], limit=1)\n    \n    if not existing_lead:\n        # Create new lead\n        new_lead = env['crm.lead'].create({\n            'name': company_name + ' - Dubai SME Lead',\n            'partner_id': partner.id,\n            'type': 'opportunity',\n            'phone': company_phone,\n            'email_from': company_email, \n            'website': company_website,\n            'street': company_address,\n            'city': 'Dubai',\n            'priority': lead_priority,\n            'description': description,\n            'user_id': env.user.id\n        })\n        \n        # Add tags\n        tag_names = ['Dubai SME', company_category, 'Google Maps']\n        for tag_name in tag_names:\n            if tag_name:\n                tag = env['crm.tag'].search([('name', '=', tag_name)], limit=1)\n                if not tag:\n                    tag = env['crm.tag'].create({'name': tag_name})\n                new_lead.write({'tag_ids': [(4, tag.id)]})\n    \nexcept Exception as e:\n    raise Exception(f'Webhook error: {str(e)}')",
    "response": "{'status': 'success', 'message': 'Lead processed successfully'}"
  }
}